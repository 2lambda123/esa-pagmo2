 

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Low-discrepancy sequences &mdash; pagmo 2.18.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/logo_favico.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Hypervolumes" href="hypervolume.html" />
    <link rel="prev" title="Constrained optimization utilities" href="constrained.html" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto|Comfortaa|Space+Mono"> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> pagmo
          

          
          </a>

          
            
            
              <div class="version">
                2.18.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cpp_tut.html">C++ tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../cpp_docs.html">C++ API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../cpp_docs.html#core-classes">Core classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp_docs.html#implemented-algorithms">Implemented algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp_docs.html#implemented-problems">Implemented problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp_docs.html#implemented-islands">Implemented islands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp_docs.html#implemented-batch-evaluators">Implemented batch evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp_docs.html#implemented-topologies">Implemented topologies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp_docs.html#implemented-replacement-policies">Implemented replacement policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp_docs.html#implemented-selection-policies">Implemented selection policies</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../cpp_docs.html#utilities">Utilities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="multi_objective.html">Multi-objective optimization utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="constrained.html">Constrained optimization utilities</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Low-discrepancy sequences</a></li>
<li class="toctree-l3"><a class="reference internal" href="hypervolume.html">Hypervolumes</a></li>
<li class="toctree-l3"><a class="reference internal" href="gradient_and_hessians.html">Utilities for gradient and hessians</a></li>
<li class="toctree-l3"><a class="reference internal" href="genetic_operators.html">Genetic Operators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cpp_docs.html#miscellanea">Miscellanea</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pagmo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../cpp_docs.html">C++ API documentation</a> &raquo;</li>
        
      <li>Low-discrepancy sequences</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/docs/cpp/utils/discrepancy.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="low-discrepancy-sequences">
<span id="cpp-low-discrepancy-utils"></span><h1>Low-discrepancy sequences<a class="headerlink" href="#low-discrepancy-sequences" title="Permalink to this headline">¶</a></h1>
<p>A number of utilities to generate and use low- discrepancy sequences</p>
<hr class="docutils" />
<dl class="cpp function">
<dt id="_CPPv4N5pagmo19sample_from_simplexENSt6vectorIdEE">
<span id="_CPPv3N5pagmo19sample_from_simplexENSt6vectorIdEE"></span><span id="_CPPv2N5pagmo19sample_from_simplexENSt6vectorIdEE"></span><span id="pagmo::sample_from_simplex__std::vector:double:"></span><span class="target" id="namespacepagmo_1ad505eb4f7f0f7022c7e789ec0cc6cb25"></span><span class="pre">std</span><span class="pre">::</span><span class="pre">vector</span><span class="pre">&lt;</span><span class="pre">double</span><span class="pre">&gt;</span> <code class="sig-prename descclassname"><span class="pre">pagmo</span><code class="sig-prename descclassname"><span class="pre">::</span></code></code><code class="sig-name descname"><span class="pre">sample_from_simplex</span></code><span class="sig-paren">(</span><span class="pre">std</span><span class="pre">::</span><span class="pre">vector</span><span class="pre">&lt;</span><span class="pre">double</span><span class="pre">&gt;</span> <em><span class="pre">in</span></em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5pagmo19sample_from_simplexENSt6vectorIdEE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sample from a simplex. </p>
<p>Samples a point on a <span class="math notranslate nohighlight">\(n\)</span> dimensional simplex from a <span class="math notranslate nohighlight">\(n-1\)</span> dimensional point</p>
<p>In order to generate a uniform distribution on a simplex, that is to sample a <span class="math notranslate nohighlight">\(n\)</span>-dimensional point <span class="math notranslate nohighlight">\(\mathbf x\)</span> such that <span class="math notranslate nohighlight">\(\sum_{i=1}^{n} x_i = 1\)</span> one can follow the following approach: take <span class="math notranslate nohighlight">\(n-1\)</span> random numbers from the interval (0,1)(0,1), then add a 0 and 1 to get a list of <span class="math notranslate nohighlight">\(n+1\)</span> numbers. Sort the list and record the differences between two consecutive elements. This creates a list of <span class="math notranslate nohighlight">\(n\)</span> number that, by construction, will sum up to 1. Moreover this sampling is uniform. As an example the following code would generate points distributed on a <span class="math notranslate nohighlight">\(n\)</span> dimensional simplex:</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">double</span><span class="o">&gt;&gt;</span> <span class="n">points_on_a_simplex</span><span class="p">;</span>
<span class="n">halton</span> <span class="n">ld_rng</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="n">auto</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="n">u</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="n">u</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
     <span class="n">points_on_a_simplex</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">project_to_simplex</span><span class="p">(</span><span class="n">ld_rng</span><span class="p">()));</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
<p>
See: Donald B. Rubin, The Bayesian bootstrap Ann. Statist. 9, 1981, 130-134. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>in</strong> – a <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> containing a point in <span class="math notranslate nohighlight">\(n+1\)</span> dimensions. </p>
</dd>
<dt class="field-even">Throws</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>std::invalid_argument</strong> – if the input vector elements are not in [0,1] </p></li>
<li><p><strong>std::invalid_argument</strong> – if the input vector has size 0 or 1.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> containing the projected point of <span class="math notranslate nohighlight">\(n\)</span> dimensions.</p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp class">
<dt id="_CPPv4N5pagmo14van_der_corputE">
<span id="_CPPv3N5pagmo14van_der_corputE"></span><span id="_CPPv2N5pagmo14van_der_corputE"></span><span id="pagmo::van_der_corput"></span><span class="target" id="classpagmo_1_1van__der__corput"></span><em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pagmo</span><code class="sig-prename descclassname"><span class="pre">::</span></code></code><code class="sig-name descname"><span class="pre">van_der_corput</span></code><a class="headerlink" href="#_CPPv4N5pagmo14van_der_corputE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Van der Corput sequence. </p>
<p>A Van der Corput sequence is the simplest one-dimensional low-discrepancy sequence over the unit interval; it was first described in 1935 by the Dutch mathematician Johannes van der Corput. It is constructed by reversing the base representation of the sequence of natural number (1, 2, 3, …). A positive integer <span class="math notranslate nohighlight">\(n \ge 1\)</span> is represented, in the base <span class="math notranslate nohighlight">\(b\)</span> by: <div class="math notranslate nohighlight">
\[ n = \sum_{i=0}^{L-1}d_i(n) b^i, \]</div>
 where <span class="math notranslate nohighlight">\(L\)</span> is the number of digits needed. The <span class="math notranslate nohighlight">\(n\)</span>-th number in a van der Corput sequence is thus defined as: <div class="math notranslate nohighlight">
\[ g_n=\sum_{i=0}^{L-1}d_i(n) b^{-i-1}. \]</div>
</p>
<p>so that, for example, if <span class="math notranslate nohighlight">\(b = 10\)</span>:</p>
<p><span class="math notranslate nohighlight">\( seq = \{ 0, \tfrac{1}{10}, \tfrac{2}{10}, \tfrac{3}{10}, \tfrac{4}{10}, \tfrac{5}{10}, \tfrac{6}{10}, \tfrac{7}{10}, \tfrac{8}{10}, \tfrac{9}{10}, \tfrac{1}{100}, \tfrac{11}{100}, \tfrac{21}{100}, \tfrac{31}{100}, \tfrac{41}{100}, \tfrac{51}{100}, \tfrac{61}{100}, \tfrac{71}{100}, \tfrac{81}{100}, \tfrac{91}{100}, \tfrac{2}{100}, \tfrac{12}{100}, \tfrac{22}{100}, \tfrac{32}{100}, \ldots \} \,\)</span></p>
<p>or, if <span class="math notranslate nohighlight">\(b = 2\)</span>:</p>
<p><span class="math notranslate nohighlight">\( seq = \{0, \tfrac{1}{2}, \tfrac{1}{4}, \tfrac{3}{4}, \tfrac{1}{8}, \tfrac{5}{8}, \tfrac{3}{8}, \tfrac{7}{8}, \tfrac{1}{16}, \tfrac{9}{16}, \tfrac{5}{16}, \tfrac{13}{16}, \tfrac{3}{16}, \tfrac{11}{16}, \tfrac{7}{16}, \tfrac{15}{16}, \ldots.\} \)</span></p>
<p>See: <a class="reference external" href="https://en.wikipedia.org/wiki/Van_der_Corput_sequence">https://en.wikipedia.org/wiki/Van_der_Corput_sequence</a> </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N5pagmo14van_der_corput14van_der_corputEjj">
<span id="_CPPv3N5pagmo14van_der_corput14van_der_corputEjj"></span><span id="_CPPv2N5pagmo14van_der_corput14van_der_corputEjj"></span><span id="pagmo::van_der_corput::van_der_corput__unsigned.unsigned"></span><span class="target" id="classpagmo_1_1van__der__corput_1a7f9a4fe158d8a6085d517efa253215b3"></span><code class="sig-name descname"><span class="pre">van_der_corput</span></code><span class="sig-paren">(</span><span class="pre">unsigned</span> <em><span class="pre">b</span></em> <span class="pre">=</span> <span class="pre">2u</span>, <span class="pre">unsigned</span> <em><span class="pre">n</span></em> <span class="pre">=</span> <span class="pre">0u</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5pagmo14van_der_corput14van_der_corputEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructor from base and starting element. </p>
<p>Consruct a van der Corput lowp-discrepancy sequence with base <code class="docutils literal notranslate"><span class="pre">b</span></code> and starting element position <code class="docutils literal notranslate"><span class="pre">n</span></code> </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> – base </p></li>
<li><p><strong>n</strong> – position of the starting element</p></li>
</ul>
</dd>
<dt class="field-even">Throws</dt>
<dd class="field-even"><p><strong>std::invalid_argument</strong> – if the base is 0u or 1u </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N5pagmo14van_der_corputclEv">
<span id="_CPPv3N5pagmo14van_der_corputclEv"></span><span id="_CPPv2N5pagmo14van_der_corputclEv"></span><span id="pagmo::van_der_corput::call-operator"></span><span class="target" id="classpagmo_1_1van__der__corput_1aaecfe69bc116abbc57524053dea0dc37"></span><span class="pre">double</span> <code class="sig-name descname"><span class="pre">operator()</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5pagmo14van_der_corputclEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the next number in the sequence. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the next number in the sequence </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<hr class="docutils" />
<dl class="cpp class">
<dt id="_CPPv4N5pagmo6haltonE">
<span id="_CPPv3N5pagmo6haltonE"></span><span id="_CPPv2N5pagmo6haltonE"></span><span id="pagmo::halton"></span><span class="target" id="classpagmo_1_1halton"></span><em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pagmo</span><code class="sig-prename descclassname"><span class="pre">::</span></code></code><code class="sig-name descname"><span class="pre">halton</span></code><a class="headerlink" href="#_CPPv4N5pagmo6haltonE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Halton sequence. </p>
<p>The Halton sequence is, essentially, a generalization of the van der Corput sequence to higher dimensions. It considers, along each dimension, a van der Corput sequence referred to co-prime numbers. Here, by default, we consider the sequence of all prime numbers starting from 2, 3, 5, …… so that, for example, for <code class="docutils literal notranslate"><span class="pre">dim</span></code> equal two the following sequence is generated:</p>
<p><div class="math notranslate nohighlight">
\[ seq = \left\{ (0, 0), \left(\frac 12, \frac 13\right), \left(\frac 14, \frac 23\right), \left(\frac 34, \frac 19\right), \left(\frac 18, \frac 49\right), \left(\frac 58, \frac 79\right), \left(\frac 38, \frac 29\right), ... \right\} \]</div>
</p>
<p>
See: <a class="reference external" href="https://en.wikipedia.org/wiki/Halton_sequence">https://en.wikipedia.org/wiki/Halton_sequence</a> <dl class="field-list simple">
<dt class="field-odd">param n</dt>
<dd class="field-odd"><p>selects which element of the sequence to return </p>
</dd>
<dt class="field-even">param dim</dt>
<dd class="field-even"><p>dimensions of the returned point</p>
</dd>
</dl>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N5pagmo6halton6haltonEjj">
<span id="_CPPv3N5pagmo6halton6haltonEjj"></span><span id="_CPPv2N5pagmo6halton6haltonEjj"></span><span id="pagmo::halton::halton__unsigned.unsigned"></span><span class="target" id="classpagmo_1_1halton_1a8a4191db38a1d6f5b04e8ff67569071e"></span><code class="sig-name descname"><span class="pre">halton</span></code><span class="sig-paren">(</span><span class="pre">unsigned</span> <em><span class="pre">dim</span></em> <span class="pre">=</span> <span class="pre">2u</span>, <span class="pre">unsigned</span> <em><span class="pre">n</span></em> <span class="pre">=</span> <span class="pre">0u</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5pagmo6halton6haltonEjj" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Constructor from base and starting element. </p>
<p>Consruct a Halton low-discrepancy sequence with dimension <code class="docutils literal notranslate"><span class="pre">dim</span></code> and starting element position <code class="docutils literal notranslate"><span class="pre">n</span></code> </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> – dimension </p></li>
<li><p><strong>n</strong> – position of the starting element</p></li>
</ul>
</dd>
<dt class="field-even">Throws</dt>
<dd class="field-even"><p><strong>unspecified</strong> – all exceptions thrown by <a class="reference internal" href="#classpagmo_1_1van__der__corput"><span class="std std-ref">pagmo::van_der_corput</span></a> </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N5pagmo6haltonclEv">
<span id="_CPPv3N5pagmo6haltonclEv"></span><span id="_CPPv2N5pagmo6haltonclEv"></span><span id="pagmo::halton::call-operator"></span><span class="target" id="classpagmo_1_1halton_1a31c261865209656bfa3330b938862276"></span><span class="pre">std</span><span class="pre">::</span><span class="pre">vector</span><span class="pre">&lt;</span><span class="pre">double</span><span class="pre">&gt;</span> <code class="sig-name descname"><span class="pre">operator()</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N5pagmo6haltonclEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Returns the next number in the sequence. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the next number in the sequence </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="hypervolume.html" class="btn btn-neutral float-right" title="Hypervolumes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="constrained.html" class="btn btn-neutral float-left" title="Constrained optimization utilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2020, pagmo development team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>